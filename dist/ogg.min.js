function Ogg(a){this.stream=a;this.pageExpr=new BitString("char(4):capturePattern;1:version;1:headerType;8:granulePos;4:serial;4:sequence;4:checksum;1:pageSegments;1:segments;char():frames;",{bytes:true,bigEndian:false});this.rawPages=[];this.pages=[];this.pageIdx=0;this.frames=[];this.unpacked=false}
Ogg.prototype.parsePage=function(a){var b=this.pageExpr.unpack(a);this.rawPages.push(a);b.bos=function(){return this.header==2};b.cont=function(){return this.header==0};b.eos=function(){return this.header==4};for(a=0;b.frames[a]=="&";)++a;b.frames=b.frames.substr(a);this.pages.push(b);this.frames.push(b.frames)};Ogg.prototype.pageOut=function(){return this.pageIdx+=1};Ogg.prototype.pages=function(){return this.pages};
Ogg.prototype.unpack=function(){if(!this.unpacked){for(var a,b=0;b>=0;)a=this.stream.indexOf("OggS",b),b=this.stream.indexOf("OggS",a+4),a=this.stream.substring(a,b!=-1?b:void 0),this.parsePage(a);this.headers=this.frames.slice(0,2);this.data=this.frames.slice(2);this.unpacked=true;return this.pages}};Ogg.prototype.bitstream=function(){return!this.unpacked?null:this.data.join("")};
